# å¾®æœåŠ¡æ¶æ„å®Œæ•´æŒ‡å—

## ğŸ—ï¸ **ç³»ç»Ÿæ¶æ„æ¦‚è§ˆ**

æœ¬ä½ä»£ç å¹³å°é‡‡ç”¨å¾®æœåŠ¡æ¶æ„ï¼ŒåŒ…å«ä»¥ä¸‹5ä¸ªæ ¸å¿ƒæœåŠ¡ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ä½ä»£ç å¹³å°å¾®æœåŠ¡æ¶æ„                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   Frontend  â”‚    â”‚     Backend      â”‚    â”‚ Lowcode Designerâ”‚ â”‚
â”‚  â”‚   (3200)    â”‚â—„â”€â”€â–ºâ”‚     (3000)       â”‚â—„â”€â”€â–ºâ”‚     (3300)      â”‚ â”‚
â”‚  â”‚  Vue.js UI  â”‚    â”‚  Main Service    â”‚    â”‚ Visual Designer â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚         â”‚                     â”‚                       â”‚         â”‚
â”‚         â”‚                     â”‚                       â”‚         â”‚
â”‚         â–¼                     â–¼                       â–¼         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚            Lowcode Platform Backend (3100)                 â”‚ â”‚
â”‚  â”‚                 æ ¸å¿ƒä»£ç ç”ŸæˆæœåŠ¡                            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                              â”‚                                   â”‚
â”‚                              â–¼                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚            Amis Lowcode Backend (3200)                     â”‚ â”‚
â”‚  â”‚                ç”Ÿæˆçš„ä¸šåŠ¡APIæœåŠ¡                            â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¯ **æœåŠ¡è¯¦ç»†è¯´æ˜**

### 1. **Backend (ä¸»æœåŠ¡) - Port 3000**
- **èŒè´£**: ç”¨æˆ·è®¤è¯ã€æƒé™ç®¡ç†ã€ç³»ç»Ÿé…ç½®
- **æŠ€æœ¯æ ˆ**: NestJS + PostgreSQL + Prisma
- **æ ¸å¿ƒåŠŸèƒ½**:
  - ç”¨æˆ·ç™»å½•è®¤è¯
  - è§’è‰²æƒé™ç®¡ç†
  - ç³»ç»Ÿé…ç½®ç®¡ç†
  - èœå•è·¯ç”±ç®¡ç†

### 2. **Lowcode Platform Backend (ä½ä»£ç å¹³å°æœåŠ¡) - Port 3100**
- **èŒè´£**: å®ä½“ç®¡ç†ã€ä»£ç ç”Ÿæˆã€æ¨¡æ¿ç®¡ç†
- **æŠ€æœ¯æ ˆ**: NestJS + PostgreSQL + Prisma + Handlebars
- **æ ¸å¿ƒåŠŸèƒ½**:
  - å®ä½“å’Œå­—æ®µç®¡ç†
  - å…³ç³»ç®¡ç†
  - ä»£ç æ¨¡æ¿ç®¡ç†
  - ä»£ç ç”Ÿæˆå¼•æ“
  - å¾®æœåŠ¡é€šä¿¡åè°ƒ

### 3. **Amis Lowcode Backend (ç”Ÿæˆçš„ä¸šåŠ¡æœåŠ¡) - Port 3200**
- **èŒè´£**: åŠ¨æ€ç”Ÿæˆçš„ä¸šåŠ¡APIæœåŠ¡
- **æŠ€æœ¯æ ˆ**: NestJS + PostgreSQL + Prisma (åŠ¨æ€ç”Ÿæˆ)
- **æ ¸å¿ƒåŠŸèƒ½**:
  - åŠ¨æ€CRUD API
  - Amiså…¼å®¹å“åº”æ ¼å¼
  - è‡ªåŠ¨ç”Ÿæˆçš„ä¸šåŠ¡é€»è¾‘
  - çƒ­é‡è½½æ”¯æŒ

### 4. **Lowcode Designer (å¯è§†åŒ–è®¾è®¡å™¨) - Port 3300**
- **èŒè´£**: å¯è§†åŒ–å®ä½“è®¾è®¡ã€å…³ç³»è®¾è®¡
- **æŠ€æœ¯æ ˆ**: Vue.js + Canvas/SVG
- **æ ¸å¿ƒåŠŸèƒ½**:
  - æ‹–æ‹½å¼å®ä½“è®¾è®¡
  - å¯è§†åŒ–å…³ç³»å»ºæ¨¡
  - å®æ—¶é¢„è§ˆ
  - è®¾è®¡æ•°æ®åŒæ­¥

### 5. **Frontend (å‰ç«¯åº”ç”¨) - Port 3400**
- **èŒè´£**: ç”¨æˆ·ç•Œé¢ã€ç®¡ç†æ§åˆ¶å°
- **æŠ€æœ¯æ ˆ**: Vue.js + Naive UI + Amis
- **æ ¸å¿ƒåŠŸèƒ½**:
  - ç®¡ç†ç•Œé¢
  - ä»£ç ç”Ÿæˆæ§åˆ¶å°
  - å®ä½“ç®¡ç†ç•Œé¢
  - ç³»ç»Ÿç›‘æ§é¢æ¿

## ğŸ”„ **æœåŠ¡é—´é€šä¿¡æœºåˆ¶**

### é€šä¿¡åè®®
- **HTTP/REST**: ä¸»è¦é€šä¿¡åè®®
- **WebSocket**: å®æ—¶çŠ¶æ€æ›´æ–°
- **æ¶ˆæ¯é˜Ÿåˆ—**: å¼‚æ­¥ä»»åŠ¡å¤„ç†

### ç»Ÿä¸€é€šä¿¡æ¥å£
```typescript
// æœåŠ¡æ³¨å†Œè¡¨
interface ServiceEndpoint {
  name: string;
  url: string;
  version: string;
  status: 'healthy' | 'unhealthy' | 'unknown';
  capabilities: string[];
}

// ç»Ÿä¸€è¯·æ±‚æ ¼å¼
interface ServiceRequest {
  service: string;
  endpoint: string;
  method: 'GET' | 'POST' | 'PUT' | 'DELETE';
  data?: any;
  headers?: Record<string, string>;
}

// ç»Ÿä¸€å“åº”æ ¼å¼
interface ServiceResponse<T = any> {
  success: boolean;
  data?: T;
  message?: string;
  status: number;
  duration: number;
}
```

### é“¾è·¯è¿½è¸ª
- **Trace ID**: å…¨é“¾è·¯è¯·æ±‚è¿½è¸ª
- **Request ID**: å•æ¬¡è¯·æ±‚æ ‡è¯†
- **Contextä¼ é€’**: è·¨æœåŠ¡ä¸Šä¸‹æ–‡ä¼ é€’

## ğŸ“Š **æ•°æ®åŒæ­¥æœºåˆ¶**

### 1. **å®æ—¶åŒæ­¥**
```typescript
// å®ä½“å˜æ›´åŒæ­¥
POST /api/sync/entity
{
  "entity": EntityData,
  "operation": "create" | "update" | "delete",
  "timestamp": "2024-01-01T00:00:00Z"
}
```

### 2. **æ‰¹é‡åŒæ­¥**
```typescript
// æ‰¹é‡æ•°æ®åŒæ­¥
POST /api/sync/batch
{
  "entities": EntityData[],
  "relationships": RelationshipData[],
  "syncTimestamp": "2024-01-01T00:00:00Z"
}
```

### 3. **å¢é‡åŒæ­¥**
- åŸºäºæ—¶é—´æˆ³çš„å¢é‡æ›´æ–°
- å˜æ›´æ—¥å¿—è®°å½•
- å†²çªæ£€æµ‹å’Œè§£å†³

## ğŸ›¡ï¸ **æœåŠ¡å¥åº·ç›‘æ§**

### å¥åº·æ£€æŸ¥ç«¯ç‚¹
```typescript
// å„æœåŠ¡ç»Ÿä¸€å¥åº·æ£€æŸ¥
GET /health
{
  "status": "healthy" | "unhealthy" | "degraded",
  "timestamp": "2024-01-01T00:00:00Z",
  "uptime": 123456,
  "services": {
    "database": { "status": "healthy", "responseTime": 50 },
    "codeGeneration": { "status": "healthy", "responseTime": 100 }
  }
}
```

### ç›‘æ§æŒ‡æ ‡
- **å“åº”æ—¶é—´**: æœåŠ¡å“åº”å»¶è¿Ÿ
- **é”™è¯¯ç‡**: è¯·æ±‚å¤±è´¥æ¯”ä¾‹
- **ååé‡**: æ¯ç§’å¤„ç†è¯·æ±‚æ•°
- **èµ„æºä½¿ç”¨**: CPUã€å†…å­˜ã€ç£ç›˜ä½¿ç”¨ç‡

## ğŸš€ **éƒ¨ç½²æ¶æ„**

### Docker Compose éƒ¨ç½²
```yaml
version: '3.8'
services:
  backend:
    build: ./backend
    ports: ["3000:3000"]
    environment:
      - DATABASE_URL=postgresql://...
      
  lowcode-platform-backend:
    build: ./lowcode-platform-backend
    ports: ["3100:3100"]
    depends_on: [backend]
    
  amis-lowcode-backend:
    build: ./amis-lowcode-backend
    ports: ["3200:3200"]
    depends_on: [lowcode-platform-backend]
    
  lowcode-designer:
    build: ./lowcode-designer
    ports: ["3300:3300"]
    
  frontend:
    build: ./frontend
    ports: ["3400:3400"]
    depends_on: [backend, lowcode-platform-backend]
```

### Kubernetes éƒ¨ç½²
```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: lowcode-platform
spec:
  replicas: 3
  selector:
    matchLabels:
      app: lowcode-platform
  template:
    spec:
      containers:
      - name: backend
        image: lowcode/backend:latest
        ports: [containerPort: 3000]
      - name: lowcode-platform
        image: lowcode/platform:latest
        ports: [containerPort: 3100]
```

## ğŸ”§ **å¼€å‘ç¯å¢ƒé…ç½®**

### ç¯å¢ƒå˜é‡é…ç½®
```bash
# Backend Service
DATABASE_URL=postgresql://user:pass@localhost:5432/backend_db
JWT_SECRET=your-jwt-secret
REDIS_URL=redis://localhost:6379

# Lowcode Platform Backend
LOWCODE_DATABASE_URL=postgresql://user:pass@localhost:5432/lowcode_db
BACKEND_URL=http://localhost:3000
AMIS_BACKEND_URL=http://localhost:3200
DESIGNER_URL=http://localhost:3300

# Amis Lowcode Backend
AMIS_DATABASE_URL=postgresql://user:pass@localhost:5432/amis_db
LOWCODE_PLATFORM_URL=http://localhost:3100

# Frontend
VITE_API_URL=http://localhost:3000
VITE_LOWCODE_API_URL=http://localhost:3100
VITE_AMIS_API_URL=http://localhost:3200
```

### å¯åŠ¨é¡ºåº
1. **æ•°æ®åº“æœåŠ¡**: PostgreSQL, Redis
2. **Backend**: ä¸»æœåŠ¡ (3000)
3. **Lowcode Platform Backend**: ä½ä»£ç å¹³å° (3100)
4. **Amis Lowcode Backend**: ç”Ÿæˆçš„æœåŠ¡ (3200)
5. **Lowcode Designer**: è®¾è®¡å™¨ (3300)
6. **Frontend**: å‰ç«¯åº”ç”¨ (3400)

## ğŸ“ˆ **æ€§èƒ½ä¼˜åŒ–**

### ç¼“å­˜ç­–ç•¥
- **Redisç¼“å­˜**: çƒ­ç‚¹æ•°æ®ç¼“å­˜
- **å†…å­˜ç¼“å­˜**: æ¨¡æ¿å’Œé…ç½®ç¼“å­˜
- **CDNç¼“å­˜**: é™æ€èµ„æºç¼“å­˜

### è´Ÿè½½å‡è¡¡
- **Nginx**: åå‘ä»£ç†å’Œè´Ÿè½½å‡è¡¡
- **æœåŠ¡å‘ç°**: åŠ¨æ€æœåŠ¡æ³¨å†Œå’Œå‘ç°
- **å¥åº·æ£€æŸ¥**: è‡ªåŠ¨æ•…éšœè½¬ç§»

### æ•°æ®åº“ä¼˜åŒ–
- **è¿æ¥æ± **: æ•°æ®åº“è¿æ¥å¤ç”¨
- **ç´¢å¼•ä¼˜åŒ–**: æŸ¥è¯¢æ€§èƒ½ä¼˜åŒ–
- **è¯»å†™åˆ†ç¦»**: ä¸»ä»æ•°æ®åº“æ¶æ„

## ğŸ§ª **æµ‹è¯•ç­–ç•¥**

### æµ‹è¯•å±‚çº§
1. **å•å…ƒæµ‹è¯•**: å„æœåŠ¡å†…éƒ¨é€»è¾‘æµ‹è¯•
2. **é›†æˆæµ‹è¯•**: æœåŠ¡é—´æ¥å£æµ‹è¯•
3. **E2Eæµ‹è¯•**: å®Œæ•´ä¸šåŠ¡æµç¨‹æµ‹è¯•
4. **æ€§èƒ½æµ‹è¯•**: è´Ÿè½½å’Œå‹åŠ›æµ‹è¯•

### æµ‹è¯•è¦†ç›–ç‡è¦æ±‚
- **å•å…ƒæµ‹è¯•**: â‰¥ 80%
- **é›†æˆæµ‹è¯•**: â‰¥ 70%
- **E2Eæµ‹è¯•**: æ ¸å¿ƒæµç¨‹ 100%

## ğŸ”’ **å®‰å…¨æœºåˆ¶**

### è®¤è¯æˆæƒ
- **JWT Token**: æ— çŠ¶æ€è®¤è¯
- **RBAC**: åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶
- **API Gateway**: ç»Ÿä¸€è®¤è¯å…¥å£

### æ•°æ®å®‰å…¨
- **æ•°æ®åŠ å¯†**: æ•æ„Ÿæ•°æ®åŠ å¯†å­˜å‚¨
- **ä¼ è¾“åŠ å¯†**: HTTPS/TLSé€šä¿¡
- **è®¿é—®æ—¥å¿—**: å®Œæ•´çš„è®¿é—®å®¡è®¡

## ğŸ“š **APIæ–‡æ¡£**

### Swaggeræ–‡æ¡£
- å„æœåŠ¡æä¾›å®Œæ•´çš„APIæ–‡æ¡£
- ç»Ÿä¸€çš„é”™è¯¯ç å’Œå“åº”æ ¼å¼
- äº¤äº’å¼APIæµ‹è¯•ç•Œé¢

### æ¥å£ç‰ˆæœ¬ç®¡ç†
- **è¯­ä¹‰åŒ–ç‰ˆæœ¬**: v1.0.0æ ¼å¼
- **å‘åå…¼å®¹**: æ¸è¿›å¼å‡çº§
- **åºŸå¼ƒé€šçŸ¥**: æå‰é€šçŸ¥æ¥å£å˜æ›´

## ğŸ‰ **æ€»ç»“**

è¿™ä¸ªå¾®æœåŠ¡æ¶æ„æä¾›äº†ï¼š

âœ… **é«˜å¯æ‰©å±•æ€§**: å„æœåŠ¡ç‹¬ç«‹éƒ¨ç½²å’Œæ‰©å±•
âœ… **é«˜å¯ç”¨æ€§**: æœåŠ¡æ•…éšœéš”ç¦»å’Œè‡ªåŠ¨æ¢å¤
âœ… **å¼€å‘æ•ˆç‡**: å›¢é˜Ÿå¹¶è¡Œå¼€å‘å’Œç‹¬ç«‹å‘å¸ƒ
âœ… **æŠ€æœ¯çµæ´»æ€§**: å„æœåŠ¡å¯é€‰æ‹©æœ€é€‚åˆçš„æŠ€æœ¯æ ˆ
âœ… **è¿ç»´å‹å¥½**: å®Œå–„çš„ç›‘æ§ã€æ—¥å¿—å’Œéƒ¨ç½²æœºåˆ¶

é€šè¿‡è¿™ä¸ªæ¶æ„ï¼Œæˆ‘ä»¬å®ç°äº†ä¸€ä¸ªå®Œæ•´ã€ç¨³å®šã€é«˜æ•ˆçš„ä½ä»£ç å¹³å°ï¼Œèƒ½å¤Ÿæ”¯æŒä¼ä¸šçº§çš„ä¸šåŠ¡éœ€æ±‚å’Œå¿«é€Ÿè¿­ä»£å¼€å‘ã€‚
