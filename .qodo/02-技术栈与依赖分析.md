# SoybeanAdmin NestJS 技术栈与依赖分析

## 📊 技术栈总览

### 🎯 技术选型策略
- **现代化优先**: 选择最新稳定版本的技术栈
- **类型安全**: 全链路 TypeScript 开发
- **性能优化**: 高性能的技术组合
- **生态成熟**: 选择生态系统完善的技术

## 🖥️ 前端技术栈详解

### 核心框架与构建工具

#### Vue.js 3.5.16 生态系统
```json
{
  "vue": "3.5.16",                    // Vue 3 核心框架
  "vue-router": "4.5.1",             // 路由管理
  "pinia": "3.0.3",                  // 状态管理
  "vue-i18n": "11.1.5",             // 国际化
  "vue-tsc": "2.2.10",              // TypeScript 检查
  "@vitejs/plugin-vue": "5.2.4",     // Vite Vue 插件
  "@vitejs/plugin-vue-jsx": "4.2.0"  // JSX 支持
}
```

#### 构建工具链 (Vite 6.3.5)
```json
{
  "vite": "6.3.5",                   // 极速构建工具
  "typescript": "5.8.3",             // TypeScript 编译器
  "tsx": "4.19.4",                   // TypeScript 执行器
  "@types/node": "22.15.30",         // Node.js 类型定义
  "vite-plugin-progress": "0.0.7",   // 构建进度显示
  "vite-plugin-static-copy": "^2.3.1", // 静态资源复制
  "vite-plugin-svg-icons": "2.0.1",  // SVG 图标处理
  "vite-plugin-vue-devtools": "7.7.6" // Vue 开发工具
}
```

### UI 组件与样式系统

#### Naive UI + UnoCSS 组合
```json
{
  "naive-ui": "2.41.1",              // 主UI组件库
  "tailwind-merge": "3.3.0",         // Tailwind 类合并
  "@unocss/vite": "66.1.4",          // UnoCSS Vite 插件
  "@unocss/preset-uno": "66.1.4",    // UnoCSS Uno 预设
  "@unocss/preset-icons": "66.1.4",  // 图标预设
  "@unocss/transformer-directives": "66.1.4",    // 指令转换器
  "@unocss/transformer-variant-group": "66.1.4", // 变体分组
  "@unocss/eslint-config": "66.1.4"  // ESLint 配置
}
```

#### 图标与视觉组件
```json
{
  "@iconify/vue": "5.0.0",           // 图标组件
  "@iconify/json": "2.2.347",        // 图标数据包
  "@iconify/utils": "^2.3.0",        // 图标工具
  "unplugin-icons": "22.1.0",        // 图标自动导入
  "unplugin-vue-components": "28.7.0" // 组件自动导入
}
```

### 可视化与图表组件

#### 数据可视化 (ECharts + AntV)
```json
{
  "echarts": "5.6.0",                // 数据图表库
  "@antv/x6": "^2.18.1",            // 图编辑引擎
  "@antv/x6-plugin-clipboard": "^2.1.6",     // 剪贴板插件
  "@antv/x6-plugin-dnd": "^2.1.1",          // 拖拽插件
  "@antv/x6-plugin-history": "^2.2.4",       // 历史记录
  "@antv/x6-plugin-keyboard": "^2.2.3",      // 键盘交互
  "@antv/x6-plugin-minimap": "^2.0.7",       // 小地图
  "@antv/x6-plugin-scroller": "^2.0.10",     // 滚动画布
  "@antv/x6-plugin-selection": "^2.2.2",     // 选择交互
  "@antv/x6-plugin-snapline": "^2.1.7",      // 对齐线
  "@antv/x6-plugin-transform": "^2.1.8",     // 变形工具
  "@antv/layout": "1.2.14-beta.8"            // 自动布局
}
```

### 工具库与增强功能

#### 核心工具库
```json
{
  "@vueuse/core": "13.3.0",          // Vue 组合式工具集
  "axios": "1.9.0",                  // HTTP 客户端
  "axios-retry": "4.5.0",            // 请求重试
  "dayjs": "1.11.13",                // 日期处理
  "defu": "6.1.4",                   // 对象合并工具
  "json5": "2.2.3",                  // JSON5 解析器
  "clipboard": "2.0.11",             // 剪贴板操作
  "nprogress": "0.2.0"               // 进度条
}
```

#### 开发与代码质量工具
```json
{
  "@soybeanjs/eslint-config": "1.6.1",       // ESLint 配置
  "eslint": "9.28.0",                        // 代码检查
  "eslint-plugin-vue": "10.2.0",             // Vue ESLint 插件
  "prettier-plugin-jsdoc": "^1.3.3",         // JSDoc 格式化
  "prettier-plugin-json-sort": "^0.0.2",     // JSON 排序
  "simple-git-hooks": "2.13.0",              // Git 钩子
  "@elegant-router/vue": "0.3.8"             // 路由生成器
}
```

### 低代码相关组件

#### Amis 低代码框架
```json
{
  "amis": "6.11.0",                  // Amis 低代码框架
  "@maita/amis-tools": "^0.1.7",     // Amis 工具集
  "vue-draggable-plus": "0.6.0"      // 拖拽组件
}
```

## ⚙️ 后端技术栈详解

### NestJS 核心框架生态

#### 框架核心 (NestJS 11.0.12)
```json
{
  "@nestjs/common": "^11.0.12",      // 核心模块
  "@nestjs/core": "^11.0.12",        // 核心功能
  "@nestjs/platform-fastify": "^11.0.12", // Fastify 适配器
  "@nestjs/config": "^4.0.2",        // 配置管理
  "@nestjs/cli": "^10.4.9",          // CLI 工具
  "@nestjs/schematics": "^11.0.2",   // 代码生成器
  "@nestjs/testing": "^11.0.12"      // 测试工具
}
```

#### 架构模式支持
```json
{
  "@nestjs/cqrs": "^11.0.3",         // CQRS 模式
  "@nestjs/event-emitter": "^3.0.1", // 事件发射器
  "@nestjs/microservices": "^11.0.12", // 微服务支持
  "@nestjs/schedule": "^5.0.1",      // 定时任务
  "@nestjs/terminus": "^11.0.0"      // 健康检查
}
```

### Web 服务器与中间件

#### Fastify 生态系统 (5.2.2)
```json
{
  "fastify": "^5.2.2",               // 高性能 Web 框架
  "@fastify/compress": "^8.0.1",     // 压缩中间件
  "@fastify/cors": "^10.0.1",        // CORS 支持
  "@fastify/helmet": "^13.0.1",      // 安全头
  "@fastify/multipart": "^9.0.3",    // 文件上传
  "@fastify/static": "^8.1.1",       // 静态文件
  "@fastify/csrf-protection": "^7.1.0", // CSRF 防护
  "@fastify/rate-limit": "^10.3.0"   // 速率限制
}
```

### 数据库与 ORM

#### Prisma ORM (6.5.0)
```json
{
  "@prisma/client": "^6.5.0",        // Prisma 客户端
  "prisma": "^6.5.0"                 // Prisma CLI
}
```

**Prisma 特性优势**:
- **类型安全**: 自动生成 TypeScript 类型
- **数据库迁移**: 版本化的数据库迁移
- **多数据库支持**: PostgreSQL, MySQL, SQLite, MongoDB
- **查询优化**: 自动查询优化
- **关系处理**: 优雅的关系数据处理

### 认证与授权

#### JWT 认证生态
```json
{
  "@nestjs/jwt": "^11.0.0",          // JWT 模块
  "@nestjs/passport": "^11.0.5",     // Passport 集成
  "passport": "^0.7.0",              // 认证中间件
  "passport-jwt": "^4.0.1",          // JWT 策略
  "bcryptjs": "^3.0.2",              // 密码加密
  "crypto-js": "^4.2.0"              // 加密工具
}
```

#### 权限管理 (Casbin)
```json
{
  "casbin": "^5.38.0"                // 权限控制库
}
```

### 缓存与存储

#### Redis 生态系统
```json
{
  "@nestjs/cache-manager": "^3.0.1", // 缓存管理器
  "cache-manager": "^6.4.1",         // 缓存抽象层
  "ioredis": "^5.6.0",               // Redis 客户端
  "@keyv/redis": "^4.3.2",           // Keyv Redis 适配器
  "keyv": "^5.3.2",                  // 键值存储抽象
  "@nest-lab/throttler-storage-redis": "^1.1.0" // 限流存储
}
```

### 文档与 API

#### Swagger/OpenAPI
```json
{
  "@nestjs/swagger": "^11.1.0",      // Swagger 集成
  "@nestjs/throttler": "^6.4.0"      // API 限流
}
```

### 工具库与增强功能

#### HTTP 客户端与工具
```json
{
  "@nestjs/axios": "^4.0.0",         // HTTP 客户端模块
  "axios": "^1.10.0",                // HTTP 客户端
  "ulid": "^3.0.0",                  // ULID 生成器
  "uuid": "^11.1.0",                 // UUID 生成器
  "js-yaml": "^4.1.0",               // YAML 解析器
  "class-transformer": "^0.5.1",     // 类转换器
  "class-validator": "^0.14.1"       // 类验证器
}
```

#### 日志与监控
```json
{
  "nest-winston": "^1.10.2",         // Winston 集成
  "winston": "^3.17.0",              // 日志库
  "winston-daily-rotate-file": "^5.0.0", // 日志轮转
  "systeminformation": "^5.25.11",   // 系统信息
  "prom-client": "^15.0.0"           // Prometheus 指标
}
```

#### 文件处理与存储
```json
{
  "ali-oss": "^6.22.0",              // 阿里云 OSS
  "fs-extra": "^11.3.0",             // 文件系统扩展
  "chokidar": "^3.5.3",              // 文件监控
  "handlebars": "^4.7.8"             // 模板引擎
}
```

## 🗄️ 数据库技术栈

### PostgreSQL 16.3 生态

#### 核心数据库特性
- **ACID 事务支持**: 完整的事务保证
- **JSON/JSONB 支持**: 灵活的文档存储
- **多Schema 支持**: 逻辑数据隔离
- **全文搜索**: 内置搜索引擎
- **扩展性**: 丰富的扩展插件

#### 连接池管理 (PgBouncer 1.23.1)
```yaml
# PgBouncer 配置
PGBOUNCER_POOL_MODE: transaction    # 事务级连接池
PGBOUNCER_MAX_CLIENT_CONN: 100      # 最大客户端连接
PGBOUNCER_DEFAULT_POOL_SIZE: 20     # 默认连接池大小
```

### Redis 7.2.0 技术栈

#### Redis Stack 组件
- **Redis Core**: 高性能键值存储
- **RedisJSON**: JSON 数据类型支持
- **RedisSearch**: 全文搜索引擎
- **RedisTimeSeries**: 时序数据存储
- **RedisBloom**: 概率数据结构

#### 使用场景分工
```yaml
# Redis 数据库分配
DB 1: backend           # 主后端缓存
DB 2: lowcode-platform  # 低代码平台缓存  
DB 3: amis-backend      # 业务运行时缓存
```

## 🧪 测试技术栈

### 测试框架与工具

#### Jest 测试生态 (29.7.0)
```json
{
  "jest": "^29.5.0",                 // 测试框架
  "ts-jest": "^29.3.1",              // TypeScript 支持
  "@types/jest": "29.5.14",          // Jest 类型定义
  "supertest": "^7.1.0",             // HTTP 测试
  "@types/supertest": "^6.0.3"       // Supertest 类型
}
```

#### 测试配置类型
- **单元测试**: 组件和服务的单元测试
- **集成测试**: API 端点集成测试
- **E2E测试**: 端到端业务流程测试
- **性能测试**: API 性能基准测试

### 代码质量工具

#### ESLint + Prettier 组合
```json
{
  "eslint": "^9.23.0",               // 代码检查
  "@typescript-eslint/eslint-plugin": "^8.29.0", // TS ESLint 插件
  "@typescript-eslint/parser": "^8.29.0",        // TS 解析器
  "eslint-config-prettier": "^10.1.1",           // Prettier 集成
  "eslint-plugin-prettier": "^5.2.5",            // Prettier 插件
  "prettier": "^3.5.3"                           // 代码格式化
}
```

## 🐳 容器化与部署技术栈

### Docker 容器技术

#### 多阶段构建策略
```dockerfile
# 示例: lowcode-platform-backend Dockerfile
FROM node:18-alpine AS base      # 基础镜像
FROM base AS deps               # 依赖安装阶段  
FROM deps AS build              # 构建阶段
FROM base AS final              # 最终运行镜像
```

#### 镜像优化技术
- **分层缓存**: 合理的指令排序
- **多阶段构建**: 减小最终镜像大小
- **非root用户**: 安全性增强
- **健康检查**: 容器健康状态监控

### Docker Compose 编排

#### 服务编排配置
```yaml
# 服务依赖关系
services:
  postgres:        # 数据库服务 (最底层)
  redis:          # 缓存服务 (最底层)
  backend:        # 主后端服务 (依赖数据库)
  lowcode-platform: # 低代码平台 (依赖后端)
  amis-backend:   # 业务运行时 (依赖平台)
  frontend:       # 前端服务 (依赖所有后端)
```

#### 网络与存储
- **自定义网络**: 服务间安全通信
- **数据卷**: 持久化数据存储
- **环境变量**: 配置参数管理
- **健康检查**: 服务可用性监控

## 📊 性能优化技术

### 前端性能优化

#### 构建优化技术
- **Tree Shaking**: 无用代码消除
- **代码分割**: 路由级别分割
- **懒加载**: 组件按需加载
- **资源压缩**: Gzip/Brotli 压缩
- **缓存策略**: 浏览器缓存优化

#### 运行时优化
- **虚拟滚动**: 大列表性能优化
- **防抖节流**: 用户交互优化
- **图片懒加载**: 图片资源优化
- **预加载**: 关键资源预加载

### 后端性能优化

#### 数据库优化
- **索引策略**: 查询性能优化
- **连接池**: 连接资源管理
- **查询优化**: SQL 查询优化
- **缓存层**: 多级缓存策略

#### 应用优化
- **异步处理**: 非阻塞IO操作
- **事件驱动**: 松耦合架构
- **中间件**: 请求处理优化
- **内存管理**: 内存使用优化

## 🔧 开发工具链

### 包管理与构建

#### PNPM 包管理器
```json
{
  "packageManager": "pnpm@8.7.0",    // 快速、节省空间的包管理器
  "engines": {
    "node": ">=18.20.0",             // Node.js 版本要求
    "pnpm": ">=8.7.0"                // PNPM 版本要求
  }
}
```

**PNPM 优势**:
- **磁盘效率**: 硬链接节省存储空间
- **安装速度**: 并行安装提升速度
- **严格性**: 避免幽灵依赖问题
- **Monorepo**: 出色的 monorepo 支持

### IDE 与开发体验

#### TypeScript 开发环境
- **类型检查**: 编译时类型安全
- **智能提示**: 完整的代码补全
- **重构支持**: 安全的代码重构
- **调试体验**: 源码级调试支持

#### 热重载与开发服务器
- **Vite HMR**: 极速热模块替换
- **NestJS Watch**: 后端代码热重载
- **类型检查**: 实时类型错误提示
- **自动重启**: 配置变更自动重启

## 🚀 技术栈优势总结

### 类型安全优势
- **全链路 TypeScript**: 从前端到后端的完整类型安全
- **Prisma 类型生成**: 数据库操作的类型安全
- **API 类型共享**: 前后端类型定义共享

### 性能优势
- **Fastify 性能**: 高性能的 Web 框架
- **Vite 构建速度**: 极速的开发构建
- **Redis 缓存**: 高性能缓存系统
- **PostgreSQL 优化**: 高性能数据库引擎

### 开发体验优势
- **热重载**: 快速的开发反馈
- **自动代码生成**: 减少重复代码编写
- **完整的工具链**: 从开发到部署的完整工具
- **现代化语法**: 最新的语言特性支持

### 可维护性优势
- **模块化架构**: 清晰的模块边界
- **一致的代码风格**: 统一的代码规范
- **完整的测试**: 高覆盖率的测试体系
- **文档完整**: 详细的技术文档

这个技术栈组合代表了现代 Web 应用开发的最佳实践，平衡了开发效率、应用性能、代码质量和长期维护性等多个方面的需求。