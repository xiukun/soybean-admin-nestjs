# 实体管理重构开发任务清单

## 项目概述

本项目旨在重构实体管理功能，将列表视图和设计器视图的展示方式从标签页改为顶部切换按钮，并使用 Vue 3 和 AntV X6 重构实体设计器，默认展示设计器的可视化界面。

## 已完成任务 ✅

### 1. 前端架构重构
- [x] 移除 NTabs 标签页布局
- [x] 添加顶部工具栏切换按钮
- [x] 重新设计页面布局结构
- [x] 优化响应式设计和样式

### 2. 实体设计器组件开发
- [x] 创建 `EntityDesigner.vue` 组件
- [x] 集成 AntV X6 图形编辑器
- [x] 实现实体节点可视化展示
- [x] 添加工具栏（缩放、自动布局等功能）
- [x] 支持节点拖拽和位置调整
- [x] 实现节点选择和属性编辑

### 3. 属性面板重构
- [x] 重构 `EntityPropertyPanel.vue` 组件
- [x] 优化面板布局和用户体验
- [x] 添加实体基本信息编辑
- [x] 添加外观设置（颜色、尺寸）
- [x] 添加位置设置功能
- [x] 实现快速操作按钮

### 4. 依赖管理
- [x] 安装 AntV X6 相关依赖包
- [x] 修复导入路径错误
- [x] 验证构建成功

## 核心功能特性

### 🎨 可视化设计器
- **图形节点展示**: 每个实体以卡片形式展示，包含名称、编码、表名、字段数量等信息
- **拖拽操作**: 支持节点拖拽移动和位置调整
- **缩放控制**: 提供放大、缩小、适应画布等缩放功能
- **自动布局**: 智能排列实体节点位置
- **连接线**: 支持实体间关系连线（为后续关系设计做准备）

### 🛠️ 属性编辑面板
- **基本信息**: 实体名称、编码、表名、分类、状态、描述
- **统计信息**: 字段数量、创建时间等
- **外观设置**: 节点颜色、宽度、高度自定义
- **位置设置**: 精确控制节点坐标位置
- **快速操作**: 设计字段、查看代码、导出配置、删除实体

### 🔄 视图切换
- **设计器视图**: 默认视图，提供可视化实体关系设计
- **列表视图**: 传统表格视图，便于批量管理和查看详细信息
- **无缝切换**: 顶部按钮组实现快速视图切换

## 待完成任务 📋

### 1. 高优先级任务
- [ ] **实体关系连线功能**
  - 实现实体间关系线绘制
  - 支持一对一、一对多、多对多关系
  - 关系线样式和标签配置

- [ ] **数据持久化**
  - 保存实体位置信息到后端
  - 保存设计器布局配置
  - 实现设计器状态恢复

- [ ] **性能优化**
  - 大量实体时的渲染优化
  - 虚拟滚动支持
  - 节点懒加载

### 2. 中优先级任务
- [ ] **增强交互功能**
  - 多选节点操作
  - 批量移动和对齐
  - 撤销/重做功能
  - 快捷键支持

- [ ] **导入导出功能**
  - 设计器配置导出
  - 从文件导入实体设计
  - 图片导出功能

- [ ] **模板和预设**
  - 常用实体模板
  - 布局预设方案
  - 主题样式配置

### 3. 低优先级任务
- [ ] **协作功能**
  - 多人同时编辑
  - 变更历史记录
  - 评论和标注

- [ ] **高级功能**
  - 实体分组管理
  - 图层管理
  - 小地图导航

## 技术架构

### 前端技术栈
- **Vue 3.5+**: 组合式 API 和响应式系统
- **AntV X6 2.18+**: 图形编辑器核心引擎
- **Naive UI**: UI 组件库
- **TypeScript**: 类型安全
- **UnoCSS**: 原子化 CSS

### 核心组件结构
```
src/views/lowcode/entity/
├── index.vue                 # 主页面（重构后）
├── components/
│   ├── EntityDesigner.vue    # 实体设计器（新增）
│   └── EntityPropertyPanel.vue # 属性面板（重构）
```

### AntV X6 插件集成
- `@antv/x6-plugin-selection`: 选择功能
- `@antv/x6-plugin-snapline`: 对齐辅助线
- `@antv/x6-plugin-keyboard`: 键盘快捷键
- `@antv/x6-plugin-clipboard`: 复制粘贴
- `@antv/x6-plugin-history`: 历史记录
- `@antv/x6-plugin-scroller`: 画布滚动

## 开发规范

### 代码规范
- 使用 TypeScript 严格模式
- 遵循 Vue 3 组合式 API 最佳实践
- 组件函数添加完整的 JSDoc 注释
- 使用 ESLint 和 Prettier 保持代码风格一致

### 命名规范
- 组件名使用 PascalCase
- 函数名使用 camelCase
- 常量使用 UPPER_SNAKE_CASE
- CSS 类名使用 kebab-case

### 性能考虑
- 合理使用 Vue 3 的 ref 和 reactive
- 避免不必要的重新渲染
- 大数据集使用虚拟滚动
- 图形渲染使用 requestAnimationFrame

## 测试策略

### 单元测试
- [ ] 组件渲染测试
- [ ] 用户交互测试
- [ ] 数据处理逻辑测试

### 集成测试
- [ ] 页面路由测试
- [ ] API 接口测试
- [ ] 跨组件通信测试

### E2E 测试
- [ ] 完整用户流程测试
- [ ] 浏览器兼容性测试
- [ ] 性能基准测试

## 部署和发布

### 构建验证
- [x] 开发环境构建成功
- [x] 生产环境构建成功
- [ ] 构建产物大小优化

### 发布流程
- [ ] 代码审查
- [ ] 测试用例通过
- [ ] 文档更新
- [ ] 版本标签创建

## 文档和培训

### 开发文档
- [x] 开发需求文档
- [x] 技术架构文档
- [ ] API 接口文档
- [ ] 组件使用文档

### 用户文档
- [ ] 功能使用指南
- [ ] 最佳实践文档
- [ ] 常见问题解答
- [ ] 视频教程

## 风险和挑战

### 技术风险
- **性能问题**: 大量实体时的渲染性能
- **兼容性**: 不同浏览器的图形渲染差异
- **内存泄漏**: X6 实例的正确销毁

### 解决方案
- 实施渐进式加载和虚拟化
- 充分测试主流浏览器
- 严格的生命周期管理

## 总结

本次重构成功实现了实体管理界面的现代化升级，从传统的标签页布局转换为更加直观的可视化设计器。通过集成 AntV X6 图形编辑器，为用户提供了强大的实体关系设计能力。

### 主要成果
1. **用户体验提升**: 直观的可视化界面替代了传统的表格视图
2. **空间利用优化**: 顶部切换按钮节省了界面空间
3. **功能扩展性**: 为后续关系设计和高级功能奠定了基础
4. **技术架构升级**: 采用现代化的前端技术栈

### 下一步计划
1. 完善实体关系连线功能
2. 实现数据持久化和状态管理
3. 优化性能和用户体验
4. 添加更多高级功能

---

**开发团队**: Trae AI Assistant  
**更新时间**: 2024年12月19日  
**版本**: v1.0.0