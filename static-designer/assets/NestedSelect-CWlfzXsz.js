import{bX as se,f3 as re,f4 as ae,f5 as le,b as W,d as k,ef as te,R as v,as as ie,$ as A,af as I,dK as oe,c as x,eN as H,f6 as M,eS as q,f7 as de,cf as D,f8 as K,f9 as ue,bI as ce,a7 as X,bf as he,eh as G,fa as pe,c8 as Q,I as ve,bo as fe,O as me,P as ye,dI as Y,em as ge,e4 as Ce,ad as be,en as ke,fb as Oe,dJ as Ne,a1 as F,a2 as l,e9 as Se}from"./amis-CpcGROCB.js";import{g as Fe}from"./react-vendor-DeqkGhWy.js";var $,Z;function Ee(){if(Z)return $;Z=1;var _=se(),a=re(),e=ae(),t=le(),s=a(function(r){return e(_(r,1,t,!0))});return $=s,$}var Pe=Ee();const ee=Fe(Pe);var ne=function(_){W(a,_);function a(){var e=_!==null&&_.apply(this,arguments)||this;return e.outTarget=v.createRef(),e.state={isOpened:!1,isFocused:!1,inputValue:"",stack:[e.props.options]},e}return a.prototype.domRef=function(e){this.target=e},a.prototype.componentDidUpdate=function(e){e.options!==this.props.options&&this.setState({stack:[this.props.options]})},a.prototype.doAction=function(e,t,s){var r,n,i=this.props,o=i.resetValue,d=i.onChange,u=i.formStore,h=i.store,c=i.name,m=e==null?void 0:e.actionType;if(m==="clear")d==null||d("");else if(m==="reset"){var C=(n=ie((r=u==null?void 0:u.pristine)!==null&&r!==void 0?r:h==null?void 0:h.pristine,c))!==null&&n!==void 0?n:o;d==null||d(C??"")}},a.prototype.dispatchEvent=function(e,t){return t===void 0&&(t={}),A(this,void 0,void 0,function(){var s,r,n,i,o,d,u;return I(this,function(h){switch(h.label){case 0:return s=this.props,r=s.dispatchEvent,n=s.options,i=s.multiple,o=s.value,d=s.selectedOptions,[4,r(e,oe(this.props,x({options:n,items:n,value:o,selectedItems:i?d:d[0]},t)))];case 1:return u=h.sent(),[2,!!(u!=null&&u.prevented)]}})})},a.prototype.isParentNode=function(e){return Array.isArray(e.children)&&e.children.length>0},a.prototype.handleOutClick=function(e){var t;e.stopPropagation(),this.outTargetWidth=(t=this.outTarget.current)===null||t===void 0?void 0:t.clientWidth,e.defaultPrevented||this.setState(function(s){return{isOpened:!s.isOpened}})},a.prototype.handleResultClear=function(){this.setState({inputValue:void 0})},a.prototype.close=function(){this.setState({isOpened:!1})},a.prototype.removeItem=function(e,t){return A(this,void 0,void 0,function(){var s,r,n,i,o;return I(this,function(d){switch(d.label){case 0:return s=this.props,r=s.onChange,n=s.selectedOptions,t&&t.stopPropagation(),n.splice(e,1),i=this.getValue(),[4,this.dispatchEvent("change",{value:i})];case 1:return o=d.sent(),o||r(i),[2]}})})},a.prototype.renderValue=function(e,t){var s=this.props,r=s.classnames,n=s.labelField,i=s.valueField,o=s.options,d=s.hideNodePathLabel,u=this.state.inputValue||"",h=H(u);if(d)return M(e[n||"label"]);var c=q(o,e,!0),m=M(e[n||"label"]),C=" / ",V=c?c.map(function(N){return M(N[n||"label"])}).join(C):m;return v.createElement("span",{className:r("Select-valueLabel"),key:t||e[i||"value"],title:V},c?c.map(function(N,P){var y=M(N[n||"label"]),g=N[i||"value"],w=P===c.length-1;return v.createElement("span",{key:P},h.test(g)||h.test(y)?de(y,u):y,!w&&C)}):m)},a.prototype.handleOptionClick=function(e){return A(this,void 0,void 0,function(){var t,s,r,n,i,o,d,u,h;return I(this,function(c){switch(c.label){case 0:return t=this.props,s=t.multiple,r=t.onChange,n=t.joinValues,i=t.extractValue,o=t.valueField,d=t.onlyLeaf,s?[2]:(u=n||i?e[o||"value"]:e,u===void 0?[2]:d&&this.isParentNode(e)?[2]:[4,this.dispatchEvent("change",{value:u})]);case 1:return h=c.sent(),h||r(u),h||this.handleResultClear(),this.setState({stack:[this.props.options]}),this.close(),[2]}})})},a.prototype.handleCheck=function(e,t,s){return A(this,void 0,void 0,function(){var r,n,i,o,d,u,h,c,m,C,V,N,P,y,g,w,R,R,f,p,S,O;return I(this,function(E){switch(E.label){case 0:if(r=this.props,n=r.onChange,i=r.selectedOptions,o=r.joinValues,d=r.delimiter,u=r.extractValue,h=r.withChildren,c=r.onlyChildren,m=r.cascade,C=r.options,V=r.onlyLeaf,N=this.state.stack,P=this.props.valueField||"value",V&&!Array.isArray(e)&&this.isParentNode(e))return[2];if(!Array.isArray(e)&&e.children&&e.children.length&&typeof t=="number"&&(N[t]?N.splice(t+1,1,e.children):N.push(e.children)),y=i,w=function(b){return ce(D(Array.isArray(b)?b:[b],function(T){return T.children&&T.children.length?null:T}))},Array.isArray(e)?(h?e=D(e):c&&(e=w(e)),g=y.length===e.length?[]:e):Array.isArray(e.children)?m?g=K(y,[e]):h?(e=D([e]),R=e.every(function(b){return!!~y.indexOf(b)}),g=(R?K:ee)(y,e)):c?(e=w(e),R=e.every(function(b){return!!~y.indexOf(b)}),g=(R?K:ee)(y,e)):(g=y.filter(function(b){return!~D([e]).indexOf(b)}),!~y.indexOf(e)&&g.push(e)):g=K(y,[e]),!m)for(f=e;;){if(p=ue(C,f),p!=null&&p.value&&p.children.every(function(b){return~g.indexOf(b)})){p.children.forEach(function(b){var T=g.indexOf(b);~T&&!h&&!c&&g.splice(T,1)}),c||g.push(p),f=p;continue}break}return S=o?g.map(function(b){return b[P]}).join(d):u?g.map(function(b){return b[P]}):g,[4,this.dispatchEvent("change",{value:S})];case 1:return O=E.sent(),O||n(S),O||this.handleResultClear(),s&&this.setState({stack:[this.props.options]}),[2]}})})},a.prototype.allChecked=function(e){var t=this,s=this.props,r=s.selectedOptions,n=s.withChildren,i=s.onlyChildren;return e.every(function(o){return(n||i)&&o.children?t.allChecked(o.children):r.some(function(d){return d===o})})},a.prototype.partialChecked=function(e){var t=this;return e.some(function(s){var r=s.children&&t.partialChecked(s.children);return r||t.props.selectedOptions.some(function(n){return n===s})})},a.prototype.reload=function(){var e=this.props.reloadOptions;e&&e()},a.prototype.getValue=function(){var e=this.props,t=e.selectedOptions,s=e.joinValues,r=e.valueField,n=e.extractValue,i=e.delimiter,o=e.value;return s?o=t.map(function(d){return d[r||"value"]}).join(i||","):n&&(o=t.map(function(d){return d[r||"value"]})),o},a.prototype.onFocus=function(e){return A(this,void 0,void 0,function(){var t,s,r,n,i;return I(this,function(o){switch(o.label){case 0:return t=this.props,s=t.onFocus,r=t.disabled,n=this.getValue(),!r&&!this.state.isOpened?(this.setState({isFocused:!0}),[4,this.dispatchEvent("focus",{value:n})]):[3,2];case 1:i=o.sent(),i||s&&s(e),o.label=2;case 2:return[2]}})})},a.prototype.onBlur=function(e){return A(this,void 0,void 0,function(){var t,s,r;return I(this,function(n){switch(n.label){case 0:return t=this.props.onBlur,s=this.getValue(),this.setState({isFocused:!1}),[4,this.dispatchEvent("blur",{value:s})];case 1:return r=n.sent(),r||t&&t(e),[2]}})})},a.prototype.getTarget=function(){return this.target||(this.target=X.findDOMNode(this)),this.target},a.prototype.handleKeyPress=function(e){e.key===" "&&(this.handleOutClick(e),e.preventDefault())},a.prototype.handleInputKeyDown=function(e){var t=this.state.inputValue,s=this.props,r=s.multiple,n=s.selectedOptions;e.key==="Backspace"&&!t&&n.length&&r&&this.removeItem(n.length-1)},a.prototype.handleInputChange=function(e){var t=this.props,s=t.options,r=t.labelField,n=t.valueField,i=e&&this.state.isOpened?he(s,function(o,d,u,h){return!!G([o].concat(h),e,{keys:[r||"label",n||"value"],threshold:G.rankings.CONTAINS}).length||!!(o.children&&o.children.length)},1,!0):s.concat();this.setState({inputValue:e,stack:[i]})},a.prototype.handleResultChange=function(e){return A(this,void 0,void 0,function(){var t,s,r,n,i,o,d,u,h,c;return I(this,function(m){switch(m.label){case 0:return t=this.props,s=t.joinValues,r=t.extractValue,n=t.delimiter,i=t.valueField,o=t.onChange,d=t.multiple,u=Array.isArray(e)?e.concat():[],!d&&!u.length?[4,this.dispatchEvent("change",{value:""})]:[3,2];case 1:return h=m.sent(),h||o(""),[2];case 2:return(s||r)&&(u=e.map(function(C){return C[i||"value"]})),s&&(u=u.join(n||",")),[4,this.dispatchEvent("change",{value:u})];case 3:return c=m.sent(),c||o(u),[2]}})})},a.prototype.getMenuSelectMenuStyle=function(){var e=this.props.options,t=this.outTargetWidth,s=pe(e),r={};return t&&(r={width:t/s}),r},a.prototype.renderOptions=function(){var e=this,t=this.props,s=t.multiple,r=t.selectedOptions,n=t.classnames,i=t.options,o=t.disabled,d=t.checkAll,u=t.checkAllLabel,h=t.translate,c=t.labelField,m=t.menuClassName,C=t.cascade,V=t.onlyChildren,N=t.testIdBuilder,P=this.props.valueField||"value",y=this.state.stack,g=this.partialChecked(i),w=this.allChecked(i);return v.createElement(v.Fragment,null,y.map(function(R,f){return v.createElement("div",{key:f,className:n("NestedSelect-menu",m),style:e.getMenuSelectMenuStyle()},s&&d&&f===0?v.createElement("div",{className:n("NestedSelect-option","checkall")},v.createElement(Q,{size:"sm",onChange:e.handleCheck.bind(e,R),checked:g,partial:g&&!w}),v.createElement("span",{onClick:e.handleCheck.bind(e,R)},h(u))):null,R.map(function(p,S){var O=N==null?void 0:N.getChild("menu-".concat(f)).getChild(p.value||S),E=q(i,p),b=E==null?void 0:E.some(function(U){return!!~r.indexOf(U)}),T=C?!1:s&&b,j=E==null?void 0:E.some(function(U){return!!U.disabled}),B=T||p.disabled||j||!!o,z=!!(p.children&&e.partialChecked(p.children)),L=T||!!~r.indexOf(p);!L&&V&&s&&e.isParentNode(p)&&e.allChecked(p.children)&&(L=!0);var J=M(p[c||"label"]);return v.createElement("div",{key:S,className:n("NestedSelect-option",{"is-active":!B&&(L||!C&&z)}),onMouseEnter:e.onMouseEnter.bind(e,p,f)},s?v.createElement(Q,{size:"sm",onChange:e.handleCheck.bind(e,p,f,!1),trueValue:p[P],checked:L||!C&&z,partial:!L,disabled:B,testIdBuilder:O==null?void 0:O.getChild("checkbox")}):null,v.createElement("div",x({className:n("NestedSelect-optionLabel",{"is-disabled":B}),onClick:function(){return!B&&(s?e.handleCheck(p,f):e.handleOptionClick(p))},title:J},O==null?void 0:O.getTestId()),J),p.children&&p.children.length?v.createElement("div",x({className:n("NestedSelect-optionArrowRight",{"is-disabled":B})},O==null?void 0:O.getChild("arrow-right").getTestId()),v.createElement(ve,{icon:"right-arrow-bold",className:"icon"})):null)}))}))},a.prototype.renderSearchResult=function(){var e=this,t=this.state,s=t.stack,r=t.inputValue,n=this.props,i=n.classnames,o=n.translate,d=n.options,u=n.labelField,h=n.valueField,c=n.cascade,m=n.selectedOptions,C=n.multiple,V=n.disabled,N=n.onlyChildren,P=n.render,y=this.props.noResultsText;y&&(y=P("noResultText",o(y)));var g=H(r||""),w=D(s[0]).filter(function(f){return!!(g.test(f[h||"value"])||g.test(f[u||"label"]))}),R=v.createElement("div",{className:i("NestedSelect-menu"),style:this.getMenuSelectMenuStyle()},w.length?w.map(function(f,p){var S=q(d,f),O=c?!1:C&&(S==null?void 0:S.some(function(j){return!!~m.indexOf(j)})),E=O||f.disabled||!!V||(S==null?void 0:S.some(function(j){return!!j.disabled})),b=!!(f.children&&e.partialChecked(f.children)),T=O||!!~m.indexOf(f);return!T&&N&&e.isParentNode(f)&&e.allChecked(f.children)&&(T=!0),v.createElement("div",{className:i("NestedSelect-option",{"is-active":!E&&(T||!c&&b)}),key:p},v.createElement("div",{className:i("NestedSelect-optionLabel",{"is-disabled":E}),onClick:function(){!E&&(C?e.handleCheck(f,f.value,!0):e.handleOptionClick(f))}},e.renderValue(f,f.value)))}):v.createElement("div",{className:i("NestedSelect-option",{"no-result":!0})},y));return R},a.prototype.onMouseEnter=function(e,t,s){var r=this.state.stack;t=t+1;var n=e.children;n&&n.length?r[t]?r.splice(t,1,n):r.push(n):r[t]&&r.splice(t,1),this.setState({stack:r.slice(0,t+1)})},a.prototype.renderOuter=function(){var e=this,t=this.props,s=t.popOverContainer,r=t.translate,n=t.classnames,i=t.options,o=t.render,d=t.id,u=t.themeCss,h=!!this.state.inputValue,c=this.props.noResultsText;c&&(c=o("noResultText",r(c)));var m=v.createElement(fe,{disabled:!this.state.isOpened,onRootClose:this.close},function(C){return v.createElement("div",{className:n("NestedSelect-menuOuter"),ref:C},h?e.renderSearchResult():i.length?e.renderOptions():v.createElement("div",{className:n("NestedSelect-noResult")},c))});return v.createElement(me,{target:this.getTarget,container:s||function(){return X.findDOMNode(e)},placement:"auto",show:!0},v.createElement(ye,{className:n("NestedSelect-popover",Y(x(x({},this.props),{name:"nestedSelectPopoverClassName",id:d,themeCss:u})))},m))},a.prototype.render=function(){var e,t=this.props,s=t.className,r=t.style,n=t.disabled,i=t.classnames,o=t.multiple,d=t.placeholder,u=t.translate,h=t.inline,c=t.searchable,m=t.selectedOptions,C=t.clearable,V=t.loading,N=t.borderMode,P=t.mobileUI;t.popOverContainer;var y=t.env,g=t.testIdBuilder,w=t.loadingConfig,R=t.maxTagCount,f=t.overflowTagPopover,p=this.props,S=p.classPrefix,O=p.themeCss,E=p.id;return v.createElement("div",{className:i("NestedSelectControl",s),ref:this.outTarget,style:r},v.createElement(ge,{mobileUI:P,maxTagCount:R,overflowTagPopover:f,disabled:n,ref:this.domRef,placeholder:u(d??"placeholder.empty"),inputPlaceholder:"",className:i("NestedSelect",(e={"NestedSelect--inline":h,"NestedSelect--single":!o,"NestedSelect--multi":o,"NestedSelect--searchable":c,"is-opened":this.state.isOpened,"is-focused":this.state.isFocused},e["NestedSelect--border".concat(Ce(N))]=N,e),Y(x(x({},this.props),{name:"nestedSelectControlClassName",id:E,themeCss:O}))),result:o?m:m.length?m[0]:"",onResultClick:this.handleOutClick,value:this.state.inputValue,onChange:this.handleInputChange,onResultChange:this.handleResultChange,onClear:this.handleResultClear,itemRender:this.renderValue,onKeyPress:this.handleKeyPress,onFocus:this.onFocus,onBlur:this.onBlur,onKeyDown:this.handleInputKeyDown,clearable:C,hasDropDownArrow:!0,allowInput:c&&!P,testIdBuilder:g},V?v.createElement(be,{loadingConfig:w,size:"sm"}):void 0),P?v.createElement(ke,{className:i("NestedSelect-popup"),container:y.getModalContainer,isShow:this.state.isOpened,onHide:this.close,showConfirm:!1,showClose:!1},v.createElement(Oe,x({onClose:this.close},this.props,{onChange:this.handleResultChange,options:this.props.options.slice(),value:m}))):this.state.isOpened?this.renderOuter():null,v.createElement(Ne,x({},this.props,{config:{themeCss:O,classNames:[{key:"nestedSelectControlClassName",weights:{hover:{suf:".is-clickable:not(.is-disabled)"},focused:{suf:".is-opened:not(.is-mobile)"},disabled:{suf:".is-disabled"}}},{key:"nestedSelectPopoverClassName",weights:{default:{suf:" .".concat(S,"NestedSelect-option")},hover:{suf:" .".concat(S,"NestedSelect-option.is-highlight")},focused:{inner:".".concat(S,"NestedSelect-option.is-active")}}}],id:E},env:y})))},a.defaultProps={cascade:!1,withChildren:!1,onlyChildren:!1,onlyLeaf:!1,searchPromptText:"Select.searchPromptText",noResultsText:"noResult",checkAll:!0,checkAllLabel:"Select.checkAll",hideNodePathLabel:!1},k([F,l("design:type",Function),l("design:paramtypes",[Object]),l("design:returntype",void 0)],a.prototype,"domRef",null),k([F,l("design:type",Function),l("design:paramtypes",[String,Object]),l("design:returntype",Promise)],a.prototype,"dispatchEvent",null),k([F,l("design:type",Function),l("design:paramtypes",[Object]),l("design:returntype",void 0)],a.prototype,"handleOutClick",null),k([F,l("design:type",Function),l("design:paramtypes",[]),l("design:returntype",void 0)],a.prototype,"handleResultClear",null),k([F,l("design:type",Function),l("design:paramtypes",[]),l("design:returntype",void 0)],a.prototype,"close",null),k([F,l("design:type",Function),l("design:paramtypes",[Object,Object]),l("design:returntype",void 0)],a.prototype,"renderValue",null),k([F,l("design:type",Function),l("design:paramtypes",[Object]),l("design:returntype",Promise)],a.prototype,"handleOptionClick",null),k([F,l("design:type",Function),l("design:paramtypes",[Object,Number,Boolean]),l("design:returntype",Promise)],a.prototype,"handleCheck",null),k([F,l("design:type",Function),l("design:paramtypes",[]),l("design:returntype",void 0)],a.prototype,"getValue",null),k([F,l("design:type",Function),l("design:paramtypes",[Object]),l("design:returntype",Promise)],a.prototype,"onFocus",null),k([F,l("design:type",Function),l("design:paramtypes",[Object]),l("design:returntype",Promise)],a.prototype,"onBlur",null),k([F,l("design:type",Function),l("design:paramtypes",[]),l("design:returntype",void 0)],a.prototype,"getTarget",null),k([F,l("design:type",Function),l("design:paramtypes",[Object]),l("design:returntype",void 0)],a.prototype,"handleKeyPress",null),k([F,l("design:type",Function),l("design:paramtypes",[Object]),l("design:returntype",void 0)],a.prototype,"handleInputKeyDown",null),k([F,l("design:type",Function),l("design:paramtypes",[String]),l("design:returntype",void 0)],a.prototype,"handleInputChange",null),k([F,l("design:type",Function),l("design:paramtypes",[Array]),l("design:returntype",Promise)],a.prototype,"handleResultChange",null),k([F,l("design:type",Function),l("design:paramtypes",[]),l("design:returntype",void 0)],a.prototype,"getMenuSelectMenuStyle",null),k([Se(),l("design:type",Function),l("design:paramtypes",[]),l("design:returntype",void 0)],a.prototype,"render",null),a}(v.Component),Te=function(_){W(a,_);function a(){return _!==null&&_.apply(this,arguments)||this}return a=k([te({type:"nested-select"})],a),a}(ne),we=function(_){W(a,_);function a(){return _!==null&&_.apply(this,arguments)||this}return a=k([te({type:"cascader-select"})],a),a}(ne);export{we as CascaderSelectControlRenderer,Te as NestedSelectControlRenderer,ne as default};
