import{et as J,eu as U,b as W,d as k,ef as V,R as d,as as H,k as K,c8 as q,ae as Q,ev as M,I as O,ew as j,ex as X,ey as Y,dI as Z,c as B,ad as ee,dJ as te,a1 as N,a2 as r,e9 as ae}from"./amis-CpcGROCB.js";import{g as ne}from"./react-vendor-DeqkGhWy.js";var w,P;function le(){if(P)return w;P=1;var b=Math.max,n=Math.min;function e(t,l,o){return t>=n(l,o)&&t<b(l,o)}return w=e,w}var D,z;function se(){if(z)return D;z=1;var b=le(),n=J(),e=U();function t(l,o,a){return o=n(o),a===void 0?(a=o,o=0):a=n(a),l=e(l),b(l,o,a)}return D=t,D}var oe=se();const re=ne(oe);var ie=function(b){W(n,b);function n(){var e=b!==null&&b.apply(this,arguments)||this;return e.checkboxRef=d.createRef(),e.childRefs=[],e}return n.prototype.doAction=function(e,t,l){var o,a,s=this.props,h=s.resetValue,u=s.onChange,i=s.formStore,p=s.store,m=s.name,f=e==null?void 0:e.actionType;if(f==="clear")u("");else if(f==="reset"){var v=(a=H((o=i==null?void 0:i.pristine)!==null&&o!==void 0?o:p==null?void 0:p.pristine,m))!==null&&a!==void 0?a:h;u(v??"")}},n.prototype.reload=function(){var e=this.props.reloadOptions;e&&e()},n.prototype.handleAddClick=function(){var e=this.props.onAdd;e&&e()},n.prototype.handleEditClick=function(e,t){var l=this.props.onEdit;e.preventDefault(),e.stopPropagation(),l&&l(t)},n.prototype.handleDeleteClick=function(e,t){var l=this.props.onDelete;e.preventDefault(),e.stopPropagation(),l&&l(t)},n.prototype.componentDidMount=function(){this.updateBorderStyle();var e=K(this.updateBorderStyle,100);this.checkboxRef.current&&(this.checkboxRefObserver=new ResizeObserver(e),this.checkboxRefObserver.observe(this.checkboxRef.current))},n.prototype.componentWillUnmount=function(){var e;(e=this.checkboxRefObserver)===null||e===void 0||e.disconnect()},n.prototype.updateBorderStyle=function(){if(this.props.optionType==="button"&&this.childRefs.length){var e=this.childRefs.map(function(i){return i==null?void 0:i.ref}),t=e[0].labelRef.current.offsetTop,l=[],o=e.length;l[0]="first";for(var a=0,s=1;s<o;s++){var h=e[s],u=h.labelRef.current.offsetTop;l[s]="",u!==t&&(l[s]="first",l[s-1]+=" last",a=s,t=u)}l[o-1]+=" last",l.forEach(function(i,p){p>=a&&(i+=" last-line"),e[p].setClassName(i)})}},n.prototype.renderGroup=function(e,t){var l=this,o,a=this.props,s=a.classnames,h=a.labelField;if(!(!((o=e.children)===null||o===void 0)&&o.length))return null;var u=e.children.map(function(p,m){return l.renderItem(p,m)}),i=this.columnsSplit(u);return d.createElement("div",{key:"group-"+t,className:s("CheckboxesControl-group",e.className)},d.createElement("label",{className:s("CheckboxesControl-groupLabel",e.labelClassName)},e[h||"label"]),i)},n.prototype.addChildRefs=function(e){e&&this.childRefs.push(e)},n.prototype.renderItem=function(e,t){var l=this,o;if(!((o=e.children)===null||o===void 0)&&o.length)return this.renderGroup(e,t);var a=this.props,s=a.render,h=a.itemClassName,u=a.onToggle,i=a.selectedOptions,p=a.disabled,m=a.inline,f=a.labelClassName,v=a.labelField,T=a.removable,E=a.editable,S=a.translate,I=a.optionType,g=a.menuTpl,F=a.data,y=a.testIdBuilder,R=String(e[v||"label"]),A=e.labelClassName,_=y==null?void 0:y.getChild("item-"+R||t);return d.createElement(q,{className:h,key:t,onChange:function(){return u(e)},checked:!!~i.indexOf(e),disabled:p||e.disabled,inline:m,labelClassName:A||f,description:e.description,optionType:I,testIdBuilder:_,ref:this.addChildRefs},g?s("checkboxes/".concat(t),g,{data:Q(F,e)}):R,T&&M(e,"removable")?d.createElement("a",{"data-tooltip":S("Select.clear"),"data-position":"left"},d.createElement(O,{icon:"minus",className:"icon",onClick:function(x){return l.handleDeleteClick(x,e)}})):null,E&&M(e,"editable")?d.createElement("a",{"data-tooltip":"编辑","data-position":"left"},d.createElement(O,{icon:"pencil",className:"icon",onClick:function(x){return l.handleEditClick(x,e)}})):null)},n.prototype.columnsSplit=function(e){var t=this.props,l=t.columnsCount,o=t.classnames,a=[],s=[];return e.forEach(function(h){h&&h.key&&String(h.key).startsWith("group")?(s.length&&(a.push(j(s,o,l)),s=[]),a.push(h)):s.push(h)}),s.length&&a.push(j(s,o,l)),a},n.prototype.render=function(){var e=this,t=this.props,l=t.className;t.style;var o=t.disabled,a=t.placeholder,s=t.options,h=t.inline;t.columnsCount;var u=t.selectedOptions;t.onToggle;var i=t.onToggleAll,p=t.checkAll,m=t.checkAllText,f=t.classnames,v=t.itemClassName,T=t.labelClassName,E=t.creatable,S=t.addApi,I=t.createBtnLabel,g=t.translate,F=t.optionType,y=t.loading,R=t.loadingConfig,A=t.themeCss,_=t.id,x=t.env,c=t.classPrefix,C=[];s&&s.length&&(C=s.map(function(G,$){return e.renderItem(G,$)})),p&&C.length&&F==="default"&&C.unshift(d.createElement(q,{key:"checkall",className:v,onChange:i,checked:!!u.length,partial:re(u.length,0,X(s).length),disabled:o,inline:h,labelClassName:T},m??g("Checkboxes.selectAll"))),C=this.columnsSplit(C);var L=Y(A,"checkboxes");return d.createElement("div",{className:f("CheckboxesControl",l,Z(B(B({},this.props),{name:["checkboxesControlClassName","checkboxesControlCheckedClassName","checkboxesClassName","checkboxesCheckedClassName","checkboxesInnerClassName","checkboxesShowClassName"],id:_,themeCss:L}))),ref:this.checkboxRef},C&&C.length?C:y?null:d.createElement("span",{className:"Form-placeholder"},g(a)),y?d.createElement(ee,{show:!0,icon:"reload",size:"sm",spinnerClassName:f("Checkboxes-spinner"),loadingConfig:R}):null,(E||S)&&!o?d.createElement("a",{className:f("Checkboxes-addBtn"),onClick:this.handleAddClick},d.createElement(O,{icon:"plus",className:"icon"}),g(I)):null,d.createElement(te,B({},this.props,{config:{themeCss:L,classNames:[{key:"checkboxesControlClassName",weights:{default:{inner:".".concat(c,"Checkbox:not(.checked):not(.disabled)")},hover:{suf:" .".concat(c,"Checkbox:not(.disabled):not(.checked)")},disabled:{inner:".".concat(c,"Checkbox.disabled:not(.checked)")}}},{key:"checkboxesControlCheckedClassName",weights:{default:{inner:".".concat(c,"Checkbox.checked:not(.disabled)")},hover:{suf:" .".concat(c,"Checkbox.checked:not(.disabled)")},disabled:{inner:".".concat(c,"Checkbox.checked.disabled")}}},{key:"checkboxesClassName",weights:{default:{inner:".".concat(c,"Checkbox:not(.checked):not(.disabled) > i")},hover:{suf:" .".concat(c,"Checkbox:not(.disabled):not(.checked)"),inner:"> i"},disabled:{inner:".".concat(c,"Checkbox.disabled:not(.checked) > i")}}},{key:"checkboxesCheckedClassName",weights:{default:{inner:".".concat(c,"Checkbox:not(.disabled) > i")},hover:{suf:" .".concat(c,"Checkbox:not(.disabled)"),inner:"> i"},disabled:{inner:".".concat(c,"Checkbox.disabled > i")}}},{key:"checkboxesInnerClassName",weights:{default:{inner:".".concat(c,"Checkbox:not(.disabled) > i .icon")},hover:{suf:" .".concat(c,"Checkbox:not(.disabled)"),inner:"> i .icon"},disabled:{inner:".".concat(c,"Checkbox.disabled > i .icon")}}},{key:"checkboxesShowClassName",weights:{default:{inner:".".concat(c,"Checkbox > i")}}}],id:_},env:x})))},n.defaultProps={columnsCount:1,multiple:!0,placeholder:"placeholder.noOption",creatable:!1,inline:!0,createBtnLabel:"Select.createLabel",optionType:"default"},k([N,r("design:type",Function),r("design:paramtypes",[]),r("design:returntype",void 0)],n.prototype,"handleAddClick",null),k([N,r("design:type",Function),r("design:paramtypes",[Event,Object]),r("design:returntype",void 0)],n.prototype,"handleEditClick",null),k([N,r("design:type",Function),r("design:paramtypes",[Event,Object]),r("design:returntype",void 0)],n.prototype,"handleDeleteClick",null),k([N,r("design:type",Function),r("design:paramtypes",[]),r("design:returntype",void 0)],n.prototype,"updateBorderStyle",null),k([N,r("design:type",Function),r("design:paramtypes",[Object]),r("design:returntype",void 0)],n.prototype,"addChildRefs",null),k([ae(),r("design:type",Function),r("design:paramtypes",[]),r("design:returntype",void 0)],n.prototype,"render",null),n}(d.Component),he=function(b){W(n,b);function n(){return b!==null&&b.apply(this,arguments)||this}return n=k([V({type:"checkboxes",sizeMutable:!1,thin:!0})],n),n}(ie);export{he as CheckboxesControlRenderer,ie as default};
