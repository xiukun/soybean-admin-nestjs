import{b as B,$ as O,af as I,bf as G,eh as K,M as Q,eL as M,ae as k,eJ as N,eM as U,dU as V,c as C,dK as W,d as w,a1 as E,a2 as c,fn as X,as as Y,R as L,fo as Z,co as j,ad as ee,e8 as te,ef as ae}from"./amis-WMe1Knp9.js";import{BaseTransferRenderer as re}from"./Transfer-CMFg5VxI.js";import"./react-vendor-DeqkGhWy.js";var ne=function(R){B(r,R);function r(){var e=R!==null&&R.apply(this,arguments)||this;return e.state={activeKey:0},e}return r.prototype.onTabChange=function(e){return O(this,void 0,void 0,function(){var p,t;return I(this,function(a){switch(a.label){case 0:return p=this.props.dispatchEvent,[4,p("tab-change",{key:e})];case 1:return t=a.sent(),t!=null&&t.prevented?[2]:(this.setState({activeKey:e}),[2])}})})},r.prototype.handleTabSearch=function(e,p,t){return O(this,void 0,void 0,function(){var a,i,v,s,l,f,o,m,d,u,n;return I(this,function(b){switch(b.label){case 0:if(a=this.props,i=a.options,v=a.labelField,s=a.valueField,l=a.env,f=a.data,o=a.searchApi,m=a.translate,!o)return[3,5];b.label=1;case 1:return b.trys.push([1,3,,4]),[4,l.fetcher(o,k(f,{term:e}),{cancelExecutor:t})];case 2:if(d=b.sent(),!d.ok)throw new Error(m(d.msg||"networkError"));if(u=d.data.options||d.data.items||d.data,!Array.isArray(u))throw new Error(m("CRUD.invalidArray"));return[2,u.map(function(y){var g=null,h=y[s||"value"];return Array.isArray(i)&&h!==null&&h!==void 0&&(g=Q(i,M(h,s))),g||y})];case 3:return n=b.sent(),l.isCancel(n)||!o.silent&&l.notify("error",n.message),[2,[]];case 4:return[3,6];case 5:return e?[2,G(p.children||i,function(y,g,h,_){return!!(Array.isArray(y.children)&&y.children.length||K([y].concat(_),e,{keys:[v||"label",s||"value"],threshold:K.rankings.CONTAINS}).length)},0,!0)]:[2,i];case 6:return[2]}})})},r.prototype.handleChange=function(e,p){return O(this,void 0,void 0,function(){var t,a,i,v,s,l,f,o,m,d,u,n,b,y;return I(this,function(g){switch(g.label){case 0:return t=this.props,a=t.onChange,i=t.joinValues,v=t.delimiter,s=t.valueField,l=t.extractValue,f=t.options,o=t.dispatchEvent,m=t.setOptions,d=t.translate,u=e,n=f.concat(),b="UN_MATCH_RESULT",Array.isArray(e)?(u=e.map(function(h){var _=N(f,M(h[s||"value"],s||"value"));if(_){if(p){var S=U(n,_);n=V(n,_,1,C(C({},S),h))}}else{var A=N(n,function(F){return F.value===b});if(!A)n.push({label:d("searchResult"),value:b,visible:!1,children:[h]});else{var T=U(n,A);T!=null&&T.children&&(T.children.push(h),n=V(n,A,1,C(C({},T),h)))}}return i||l?h[s||"value"]:h}),i&&(u=u.join(v||","))):e&&(u=i||l?e[s||"value"]:e),(n.length>f.length||p)&&m(n,!0),[4,o("change",W(this.props,{value:u,options:f,items:f}))];case 1:return y=g.sent(),y!=null&&y.prevented?[2]:(a(u),[2])}})})},w([E,c("design:type",Function),c("design:paramtypes",[Number]),c("design:returntype",Promise)],r.prototype,"onTabChange",null),w([E,c("design:type",Function),c("design:paramtypes",[String,Object,Function]),c("design:returntype",Promise)],r.prototype,"handleTabSearch",null),w([E,c("design:type",Function),c("design:paramtypes",[Object,Boolean]),c("design:returntype",Promise)],r.prototype,"handleChange",null),r}(re),oe=function(R){B(r,R);function r(){return R!==null&&R.apply(this,arguments)||this}return r.prototype.optionItemRender=function(e,p){var t=this.props,a=t.menuTpl,i=t.render,v=t.data,s=t.classnames,l=arguments[2]||{};return a?i("item/".concat(p.index),a,{data:k(k(v,C(C({},p),l)),e)}):X.itemRender(e,C(C({},p),{classnames:s}))},r.prototype.doAction=function(e,p,t,a){var i,v,s,l=this.props,f=l.resetValue,o=l.onChange,m=l.formStore,d=l.store,u=l.name,n=a==null?void 0:a.activeKey;switch(e.actionType){case"clear":o==null||o("");break;case"reset":o==null||o((s=(v=Y((i=m==null?void 0:m.pristine)!==null&&i!==void 0?i:d==null?void 0:d.pristine,u))!==null&&v!==void 0?v:f)!==null&&s!==void 0?s:"");break;case"changeTabKey":this.setState({activeKey:n});break}},r.prototype.render=function(){var e=this.props,p=e.className;e.style;var t=e.classnames,a=e.options,i=e.selectedOptions,v=e.sortable,s=e.loading,l=e.searchResultMode,f=e.selectMode,o=e.searchable,m=e.showArrow,d=e.deferLoad,u=e.leftDeferLoad,n=e.disabled,b=e.selectTitle,y=e.resultTitle,g=e.itemHeight,h=e.virtualThreshold,_=e.onlyChildren,A=e.loadingConfig,T=e.valueField,S=T===void 0?"value":T,F=e.labelField,D=F===void 0?"label":F,H=e.valueTpl,P=e.menuTpl,$=e.data,J=e.mobileUI,x=e.initiallyOpen,q=x===void 0?!0:x,z=e.testIdBuilder;return L.createElement("div",{className:t("TabsTransferControl",p)},L.createElement(Z,{onlyChildren:_,activeKey:this.state.activeKey,value:i,disabled:n,options:a,onChange:this.handleChange,option2value:this.option2value,sortable:v,searchResultMode:l,onSearch:this.handleTabSearch,showArrow:m,onDeferLoad:d,onLeftDeferLoad:u,selectTitle:b,resultTitle:y,selectMode:f,searchable:o,optionItemRender:P?this.optionItemRender:void 0,resultItemRender:H?this.resultItemRender:void 0,onTabChange:this.onTabChange,itemHeight:j(g)>0?j(g):void 0,virtualThreshold:h,labelField:D,valueField:S,ctx:$,mobileUI:J,initiallyOpen:q,testIdBuilder:z}),L.createElement(ee,{overlay:!0,key:"info",show:s,loadingConfig:A}))},r.defaultProps={multiple:!0},w([E,c("design:type",Function),c("design:paramtypes",[Object,Object]),c("design:returntype",void 0)],r.prototype,"optionItemRender",null),w([te(),c("design:type",Function),c("design:paramtypes",[]),c("design:returntype",void 0)],r.prototype,"render",null),r=w([ae({type:"tabs-transfer"})],r),r}(ne);export{ne as BaseTabsTransferRenderer,oe as TabsTransferRenderer};
