# 低代码平台用户指南

欢迎使用低代码平台！本指南将帮助您快速上手，从创建第一个项目到生成完整的应用代码。

## 目录

- [快速开始](#快速开始)
- [项目管理](#项目管理)
- [实体设计](#实体设计)
- [模板管理](#模板管理)
- [代码生成](#代码生成)
- [高级功能](#高级功能)
- [最佳实践](#最佳实践)
- [常见问题](#常见问题)

## 快速开始

### 1. 登录系统
访问平台地址，使用您的账号登录系统。

### 2. 创建第一个项目
1. 点击左侧菜单的"项目管理"
2. 点击"新建项目"按钮
3. 填写项目信息：
   - **项目名称**: 例如"电商管理系统"
   - **项目代码**: 例如"ecommerce-admin"
   - **项目描述**: 简要描述项目功能
   - **技术框架**: 选择 NestJS、Express 等
   - **架构模式**: 选择 DDD、Clean Architecture 等
   - **编程语言**: TypeScript、JavaScript 等
   - **数据库类型**: PostgreSQL、MySQL 等

### 3. 设计实体模型
1. 进入项目详情页面
2. 点击"实体管理"标签
3. 点击"新建实体"，创建您的第一个实体
4. 添加字段和关系

### 4. 生成代码
1. 点击"代码生成"标签
2. 选择要生成的实体和模板
3. 配置生成选项
4. 点击"生成代码"按钮
5. 下载生成的代码包

## 项目管理

### 创建项目

#### 基本信息
- **项目名称**: 项目的显示名称，支持中文
- **项目代码**: 项目的唯一标识，用于代码生成，建议使用小写字母和连字符
- **项目描述**: 详细描述项目的功能和用途

#### 技术选型
- **技术框架**: 
  - NestJS: 企业级 Node.js 框架
  - Express: 轻量级 Node.js 框架
  - Spring Boot: Java 企业级框架
  - FastAPI: Python 高性能框架

- **架构模式**:
  - DDD (领域驱动设计): 适合复杂业务系统
  - Clean Architecture: 清洁架构，职责分离
  - Base-Biz: 基础业务架构
  - Microservices: 微服务架构

- **编程语言**:
  - TypeScript: 类型安全的 JavaScript
  - JavaScript: 原生 JavaScript
  - Java: 企业级开发语言
  - Python: 简洁高效的语言

#### 项目配置
- **数据库类型**: PostgreSQL、MySQL、MongoDB
- **启用功能**:
  - 认证授权: JWT 认证系统
  - 缓存支持: Redis 缓存
  - 日志记录: 结构化日志
  - API 文档: Swagger 文档
  - 单元测试: 自动生成测试代码
  - Docker 支持: 容器化部署

### 项目设置

#### 默认字段配置
系统为每个实体自动添加以下默认字段：
- **id**: 主键，UUID 类型
- **createdAt**: 创建时间
- **updatedAt**: 更新时间
- **createdBy**: 创建人（可选）
- **updatedBy**: 更新人（可选）
- **status**: 状态字段（可选）
- **deletedAt**: 软删除时间（可选）
- **version**: 版本号（可选）
- **tenantId**: 租户ID（可选，多租户支持）

您可以在项目设置中配置哪些默认字段需要启用。

#### 代码生成配置
- **输出路径**: 代码生成的目标路径
- **包名/命名空间**: 代码的包名或命名空间
- **作者信息**: 代码注释中的作者信息
- **版权信息**: 代码文件头的版权声明

## 实体设计

### 创建实体

#### 基本信息
- **实体名称**: 实体的显示名称，如"用户"、"商品"
- **实体代码**: 实体的代码名称，如"User"、"Product"
- **表名**: 数据库表名，如"users"、"products"
- **实体描述**: 实体的详细说明

#### 字段设计

##### 字段类型
- **STRING**: 字符串类型
  - 长度: 最大字符数
  - 默认值: 字段的默认值
  - 正则验证: 字符串格式验证

- **INTEGER**: 整数类型
  - 最小值/最大值: 数值范围限制
  - 默认值: 默认数值

- **DECIMAL**: 小数类型
  - 精度: 总位数
  - 小数位: 小数点后位数

- **BOOLEAN**: 布尔类型
  - 默认值: true 或 false

- **DATE**: 日期类型
- **DATETIME**: 日期时间类型
- **TEXT**: 长文本类型
- **JSON**: JSON 对象类型
- **ENUM**: 枚举类型
  - 枚举值: 定义可选的枚举值

##### 字段属性
- **必填**: 字段是否为必填项
- **唯一**: 字段值是否必须唯一
- **索引**: 是否为字段创建数据库索引
- **可搜索**: 字段是否支持搜索功能
- **可排序**: 字段是否支持排序功能
- **显示在列表**: 字段是否在列表页面显示

#### 实体关系

##### 一对一关系 (OneToOne)
```
用户 ←→ 用户资料
User ←→ UserProfile
```
- 每个用户对应一个用户资料
- 用户资料只属于一个用户

##### 一对多关系 (OneToMany)
```
用户 ←→ 订单
User ←→ Orders
```
- 一个用户可以有多个订单
- 每个订单只属于一个用户

##### 多对多关系 (ManyToMany)
```
用户 ←→ 角色
User ←→ Roles
```
- 一个用户可以有多个角色
- 一个角色可以分配给多个用户

##### 关系配置
- **关系名称**: 关系的显示名称
- **目标实体**: 关联的目标实体
- **外键字段**: 外键字段名称
- **级联操作**: 删除时的级联行为
- **懒加载**: 是否启用懒加载

### 实体验证

系统会自动验证实体设计的合理性：
- 检查字段名称冲突
- 验证关系的完整性
- 检查循环引用
- 验证数据类型的合法性

## 模板管理

### 内置模板

平台提供了丰富的内置模板：

#### NestJS 模板
- **实体模板**: TypeORM 实体类
- **DTO 模板**: 数据传输对象
- **服务模板**: 业务逻辑服务
- **控制器模板**: REST API 控制器
- **仓储模板**: 数据访问层
- **模块模板**: NestJS 模块

#### Express 模板
- **路由模板**: Express 路由处理
- **中间件模板**: 自定义中间件
- **模型模板**: Sequelize/Mongoose 模型

#### Spring Boot 模板
- **实体模板**: JPA 实体类
- **仓储模板**: Spring Data 仓储
- **服务模板**: 业务服务类
- **控制器模板**: REST 控制器

### 自定义模板

#### 创建模板
1. 点击"模板管理"菜单
2. 点击"新建模板"按钮
3. 填写模板信息：
   - 模板名称
   - 模板分类
   - 目标语言
   - 目标框架

#### 模板语法
平台使用 Handlebars 模板引擎，支持以下语法：

##### 变量输出
```handlebars
{{entityName}}          // 实体名称
{{tableName}}           // 表名
{{description}}         // 描述
```

##### 条件判断
```handlebars
{{#if enableAudit}}
  // 审计字段相关代码
{{/if}}

{{#unless isSystemField}}
  // 非系统字段的代码
{{/unless}}
```

##### 循环遍历
```handlebars
{{#each fields}}
  {{name}}: {{type}};
{{/each}}
```

##### 内置助手函数
```handlebars
{{pascalCase entityName}}    // PascalCase 命名
{{camelCase fieldName}}      // camelCase 命名
{{kebabCase entityName}}     // kebab-case 命名
{{snakeCase fieldName}}      // snake_case 命名
{{upperCase text}}           // 大写转换
{{lowerCase text}}           // 小写转换
{{pluralize entityName}}     // 复数形式
{{singularize entityName}}   // 单数形式
```

#### 模板变量
每个模板都可以访问以下变量：
- **entityName**: 实体名称
- **tableName**: 数据库表名
- **fields**: 字段数组
- **relationships**: 关系数组
- **projectInfo**: 项目信息
- **customVariables**: 自定义变量

#### 模板验证
系统会验证模板的语法正确性：
- Handlebars 语法检查
- 变量引用验证
- 循环结构验证

### 模板版本管理

#### 版本控制
- 每次修改模板都会创建新版本
- 支持版本比较和回滚
- 可以发布稳定版本

#### 版本发布
1. 编辑模板内容
2. 测试模板生成效果
3. 填写版本说明
4. 发布新版本

## 代码生成

### 生成配置

#### 选择实体
- 可以选择单个或多个实体
- 支持按分类筛选实体
- 显示实体的字段数量和关系数量

#### 选择模板
- 按分类显示可用模板
- 显示模板的兼容性信息
- 支持模板预览功能

#### 生成选项
- **覆盖已存在文件**: 是否覆盖同名文件
- **生成测试文件**: 是否生成单元测试
- **生成文档**: 是否生成 API 文档
- **启用压缩**: 是否压缩生成的代码包

#### 自定义变量
可以为代码生成设置自定义变量：
- **包名**: 代码包名或命名空间
- **基础URL**: API 的基础路径
- **作者**: 代码作者信息
- **版本**: 代码版本号

### 代码预览

在正式生成代码前，可以预览生成效果：
- **文件结构**: 显示将要生成的文件树
- **代码内容**: 预览具体的代码内容
- **语法高亮**: 支持多种语言的语法高亮
- **实时更新**: 修改配置后实时更新预览

### 代码下载

#### 下载格式
- **ZIP 压缩包**: 包含所有生成的文件
- **文件夹结构**: 保持原有的目录结构
- **README 文件**: 包含使用说明和依赖信息

#### 生成报告
每次代码生成都会产生详细报告：
- 生成的文件数量
- 代码行数统计
- 使用的模板列表
- 生成时间和耗时
- 可能的警告信息

## 高级功能

### 模板继承

#### 基础模板
创建可复用的基础模板：
```handlebars
{{!-- base-entity.hbs --}}
export class {{entityName}} {
  {{#each fields}}
  {{name}}: {{type}};
  {{/each}}
}
```

#### 继承模板
基于基础模板创建特化模板：
```handlebars
{{!-- extends base-entity.hbs --}}
{{> base-entity}}

// 添加特定功能
export interface I{{entityName}}Service {
  findAll(): Promise<{{entityName}}[]>;
}
```

### 模板组合

将多个模板组合生成复杂的代码结构：
```handlebars
{{!-- 组合实体、服务、控制器模板 --}}
{{> entity-template}}
{{> service-template}}
{{> controller-template}}
```

### 条件生成

根据项目配置条件性生成代码：
```handlebars
{{#if project.enableAuth}}
import { AuthGuard } from '@nestjs/passport';

@UseGuards(AuthGuard('jwt'))
{{/if}}
@Controller('{{kebabCase entityName}}')
export class {{entityName}}Controller {
  // ...
}
```

### 批量操作

#### 批量创建实体
1. 准备 Excel 或 CSV 文件
2. 按照模板格式填写实体信息
3. 使用导入功能批量创建

#### 批量生成代码
1. 选择多个项目
2. 配置统一的生成选项
3. 批量执行代码生成

### API 集成

平台提供 REST API 供外部系统集成：

#### 认证
```bash
# 获取访问令牌
curl -X POST /api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"username": "your-username", "password": "your-password"}'
```

#### 项目管理
```bash
# 获取项目列表
curl -X GET /api/projects \
  -H "Authorization: Bearer your-token"

# 创建项目
curl -X POST /api/projects \
  -H "Authorization: Bearer your-token" \
  -H "Content-Type: application/json" \
  -d '{"name": "New Project", "framework": "nestjs"}'
```

#### 代码生成
```bash
# 生成代码
curl -X POST /api/code-generation \
  -H "Authorization: Bearer your-token" \
  -H "Content-Type: application/json" \
  -d '{
    "projectId": "project-id",
    "entityIds": ["entity-1", "entity-2"],
    "templateIds": ["template-1", "template-2"]
  }'
```

## 最佳实践

### 项目设计

#### 命名规范
- **项目名称**: 使用有意义的中文名称
- **项目代码**: 使用小写字母和连字符，如 `user-management-system`
- **实体名称**: 使用单数形式，如 `User`、`Product`
- **字段名称**: 使用 camelCase，如 `firstName`、`createdAt`

#### 实体设计
- **单一职责**: 每个实体只负责一个业务概念
- **合理关系**: 避免过度复杂的关系设计
- **字段完整**: 包含必要的业务字段和系统字段
- **索引优化**: 为经常查询的字段添加索引

#### 模板选择
- **框架匹配**: 选择与项目技术栈匹配的模板
- **版本兼容**: 使用稳定版本的模板
- **功能完整**: 选择功能完整的模板组合

### 代码生成

#### 生成策略
- **增量生成**: 优先使用增量生成，避免覆盖自定义代码
- **分层生成**: 分别生成不同层次的代码
- **测试优先**: 同时生成测试代码

#### 代码维护
- **版本控制**: 将生成的代码纳入版本控制
- **自定义分离**: 将自定义代码与生成代码分离
- **文档同步**: 保持代码与文档的同步

### 团队协作

#### 权限管理
- **项目权限**: 为团队成员分配合适的项目权限
- **模板权限**: 控制模板的编辑和发布权限
- **审核流程**: 建立代码生成的审核流程

#### 标准化
- **编码规范**: 统一团队的编码规范
- **模板标准**: 建立团队的模板标准
- **流程规范**: 制定标准的开发流程

## 常见问题

### Q: 如何修改已生成的代码？
A: 建议的做法是：
1. 对于业务逻辑，在生成的代码基础上进行扩展
2. 对于结构性修改，修改实体模型后重新生成
3. 使用版本控制系统管理代码变更

### Q: 生成的代码可以直接运行吗？
A: 生成的代码提供了完整的基础结构，但可能需要：
1. 安装相关依赖包
2. 配置数据库连接
3. 添加具体的业务逻辑
4. 进行必要的测试

### Q: 如何处理复杂的业务逻辑？
A: 对于复杂业务逻辑：
1. 使用自定义模板
2. 在生成的代码基础上扩展
3. 利用模板变量传递业务参数
4. 结合手工编码完成复杂功能

### Q: 支持哪些数据库？
A: 目前支持：
- PostgreSQL（推荐）
- MySQL
- SQLite
- MongoDB（部分模板）

### Q: 如何备份项目数据？
A: 可以通过以下方式备份：
1. 导出项目配置（JSON 格式）
2. 导出实体模型（Excel 格式）
3. 备份生成的代码
4. 使用 API 进行数据同步

### Q: 平台支持多语言吗？
A: 是的，平台支持：
- 界面多语言（中文、英文）
- 代码生成多语言（TypeScript、Java、Python 等）
- 模板多语言支持

### Q: 如何获得技术支持？
A: 您可以通过以下方式获得支持：
1. 查看在线文档
2. 提交问题反馈
3. 联系技术支持团队
4. 参与社区讨论

---

## 相关文档

- [部署指南](./DEPLOYMENT.md) - 详细的部署和运维指南
- [开发指南](./DEVELOPMENT.md) - 开发者文档和 API 参考
- [API 文档](./API.md) - REST API 接口文档
- [故障排除](./TROUBLESHOOTING.md) - 常见问题解决方案

希望这份用户指南能帮助您快速掌握低代码平台的使用。如果您有任何问题或建议，欢迎随时联系我们！
